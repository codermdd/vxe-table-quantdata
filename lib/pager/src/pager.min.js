"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _ctor=_interopRequireDefault(require("xe-utils/ctor")),_conf=_interopRequireDefault(require("../../conf")),_tools=require("../../tools");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ownKeys(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(r),!0).forEach(function(e){_defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function _defineProperty(e,t,r){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"===_typeof(t)?t:String(t)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);var n=r.call(e,t||"default");if("object"!==_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}var _default2={name:"VxePager",props:{size:{type:String,default:function(){return _conf.default.pager.size||_conf.default.size}},layouts:{type:Array,default:function(){return _conf.default.pager.layouts||["PrevJump","PrevPage","Jump","PageCount","NextPage","NextJump","Sizes","Total"]}},currentPage:{type:Number,default:1},loading:Boolean,pageSize:{type:Number,default:function(){return _conf.default.pager.pageSize||10}},total:{type:Number,default:0},pagerCount:{type:Number,default:function(){return _conf.default.pager.pagerCount||7}},pageSizes:{type:Array,default:function(){return _conf.default.pager.pageSizes||[10,15,20,50,100]}},align:{type:String,default:function(){return _conf.default.pager.align}},border:{type:Boolean,default:function(){return _conf.default.pager.border}},background:{type:Boolean,default:function(){return _conf.default.pager.background}},perfect:{type:Boolean,default:function(){return _conf.default.pager.perfect}},autoHidden:{type:Boolean,default:function(){return _conf.default.pager.autoHidden}},transfer:{type:Boolean,default:function(){return _conf.default.pager.transfer}},iconPrevPage:String,iconJumpPrev:String,iconJumpNext:String,iconNextPage:String,iconJumpMore:String},inject:{$xegrid:{default:null}},computed:{vSize:function(){return this.size||this.$parent.size||this.$parent.vSize},isSizes:function(){return this.layouts.some(function(e){return"Sizes"===e})},pageCount:function(){return this.getPageCount(this.total,this.pageSize)},numList:function(){for(var e=this.pagerCount-2,t=[],r=0;r<e;r++)t.push(r);return t},offsetNumber:function(){return Math.floor((this.pagerCount-2)/2)},sizeList:function(){return this.pageSizes.map(function(e){return _ctor.default.isNumber(e)?{value:e,label:"".concat(_conf.default.i18n("vxe.pager.pagesize",[e]))}:_objectSpread({value:"",label:""},e)})}},render:function(t){var e,r=this,n=this.$scopedSlots,i=this.$xegrid,a=this.vSize,u=this.align,o=[];return n.left&&o.push(t("span",{class:"vxe-pager--left-wrapper"},[n.left.call(this,{$grid:i})])),this.layouts.forEach(function(e){o.push(r["render".concat(e)](t))}),n.right&&o.push(t("span",{class:"vxe-pager--right-wrapper"},[n.right.call(this,{$grid:i})])),t("div",{class:["vxe-pager",(e={},_defineProperty(e,"size--".concat(a),a),_defineProperty(e,"align--".concat(u),u),_defineProperty(e,"is--border",this.border),_defineProperty(e,"is--background",this.background),_defineProperty(e,"is--perfect",this.perfect),_defineProperty(e,"is--hidden",this.autoHidden&&1===this.pageCount),_defineProperty(e,"is--loading",this.loading),e)]},[t("div",{class:"vxe-pager--wrapper"},o)])},methods:{renderPrevPage:function(e){return e("span",{class:["vxe-pager--prev-btn",{"is--disabled":this.currentPage<=1}],attrs:{title:_conf.default.i18n("vxe.pager.prevPage")},on:{click:this.prevPage}},[e("i",{class:["vxe-pager--btn-icon",this.iconPrevPage||_conf.default.icon.PAGER_PREV_PAGE]})])},renderPrevJump:function(e,t){return e(t||"span",{class:["vxe-pager--jump-prev",{"is--fixed":!t,"is--disabled":this.currentPage<=1}],attrs:{title:_conf.default.i18n("vxe.pager.prevJump")},on:{click:this.prevJump}},[t?e("i",{class:["vxe-pager--jump-more-icon",this.iconJumpMore||_conf.default.icon.PAGER_JUMP_MORE]}):null,e("i",{class:["vxe-pager--jump-icon",this.iconJumpPrev||_conf.default.icon.PAGER_JUMP_PREV]})])},renderNumber:function(e){return e("ul",{class:"vxe-pager--btn-wrapper"},this.renderPageBtn(e))},renderJumpNumber:function(e){return e("ul",{class:"vxe-pager--btn-wrapper"},this.renderPageBtn(e,!0))},renderNextJump:function(e,t){return e(t||"span",{class:["vxe-pager--jump-next",{"is--fixed":!t,"is--disabled":this.currentPage>=this.pageCount}],attrs:{title:_conf.default.i18n("vxe.pager.nextJump")},on:{click:this.nextJump}},[t?e("i",{class:["vxe-pager--jump-more-icon",this.iconJumpMore||_conf.default.icon.PAGER_JUMP_MORE]}):null,e("i",{class:["vxe-pager--jump-icon",this.iconJumpNext||_conf.default.icon.PAGER_JUMP_NEXT]})])},renderNextPage:function(e){return e("span",{class:["vxe-pager--next-btn",{"is--disabled":this.currentPage>=this.pageCount}],attrs:{title:_conf.default.i18n("vxe.pager.nextPage")},on:{click:this.nextPage}},[e("i",{class:["vxe-pager--btn-icon",this.iconNextPage||_conf.default.icon.PAGER_NEXT_PAGE]})])},renderSizes:function(e){var r=this;return e("vxe-select",{class:"vxe-pager--sizes",props:{value:this.pageSize,placement:"top",transfer:this.transfer,options:this.sizeList},on:{change:function(e){var t=e.value;r.pageSizeEvent(t)}}})},renderFullJump:function(e){return this.renderJump(e,!0)},renderJump:function(e,t){return e("span",{class:"vxe-pager--jump"},[t?e("span",{class:"vxe-pager--goto-text"},_conf.default.i18n("vxe.pager.goto")):null,e("input",{class:"vxe-pager--goto",domProps:{value:this.currentPage},attrs:{type:"text",autocomplete:"off"},on:{keydown:this.jumpKeydownEvent,blur:this.triggerJumpEvent}}),t?e("span",{class:"vxe-pager--classifier-text"},_conf.default.i18n("vxe.pager.pageClassifier")):null])},renderPageCount:function(e){return e("span",{class:"vxe-pager--count"},[e("span",{class:"vxe-pager--separator"}),e("span",this.pageCount)])},renderTotal:function(e){return e("span",{class:"vxe-pager--total"},_conf.default.i18n("vxe.pager.total",[this.total]))},renderPageBtn:function(n,e){var i=this,t=this.numList,a=this.currentPage,u=this.pageCount,r=this.offsetNumber,o=[],s=r+1<a,p=a<u-r,c=1;return c=u-r<=a?Math.max(u-t.length+1,1):Math.max(a-r,1),e&&s&&o.push(n("li",{class:"vxe-pager--num-btn",on:{click:function(){return i.jumpPage(1)}}},1),this.renderPrevJump(n,"li")),t.forEach(function(e,t){var r=c+t;r<=u&&o.push(n("li",{class:["vxe-pager--num-btn",{"is--active":a===r}],on:{click:function(){return i.jumpPage(r)}},key:r},r))}),e&&p&&o.push(this.renderNextJump(n,"li"),n("li",{class:"vxe-pager--num-btn",on:{click:function(){return i.jumpPage(u)}}},u)),o},getPageCount:function(e,t){return Math.max(Math.ceil(e/t),1)},prevPage:function(){var e=this.currentPage,t=this.pageCount;1<e&&this.jumpPage(Math.min(t,Math.max(e-1,1)))},nextPage:function(){var e=this.currentPage,t=this.pageCount;e<t&&this.jumpPage(Math.min(t,e+1))},prevJump:function(){this.jumpPage(Math.max(this.currentPage-this.numList.length,1))},nextJump:function(){this.jumpPage(Math.min(this.currentPage+this.numList.length,this.pageCount))},jumpPage:function(e){e!==this.currentPage&&(this.$emit("update:currentPage",e),this.$listeners["current-change"]&&(_tools.UtilTools.warn("vxe.error.delEvent",["current-change","page-change"]),this.$emit("current-change",e)),this.$emit("page-change",{type:"current",pageSize:this.pageSize,currentPage:e,$event:{type:"current"}}))},pageSizeEvent:function(e){this.changePageSize(e)},changePageSize:function(e){e!==this.pageSize&&(this.$emit("update:pageSize",e),this.$listeners["size-change"]&&(_tools.UtilTools.warn("vxe.error.delEvent",["size-change","page-change"]),this.$emit("size-change",e)),this.$emit("page-change",{type:"size",pageSize:e,currentPage:Math.min(this.currentPage,this.getPageCount(this.total,e)),$event:{type:"size"}}))},jumpKeydownEvent:function(e){13===e.keyCode?this.triggerJumpEvent(e):38===e.keyCode?(e.preventDefault(),this.nextPage()):40===e.keyCode&&(e.preventDefault(),this.prevPage())},triggerJumpEvent:function(e){var t=_ctor.default.toNumber(e.target.value),r=t<=0?1:t>=this.pageCount?this.pageCount:t;e.target.value=r,this.jumpPage(r)}}};exports.default=_default2;