"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _ctor=_interopRequireDefault(require("xe-utils/ctor")),_tools=require("../../tools");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _defineProperty(e,t,o){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"===_typeof(t)?t:String(t)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0===o)return("string"===t?String:Number)(e);var r=o.call(e,t||"default");if("object"!==_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}var cellType="footer";function mergeFooterMethod(e,t,o){for(var r=0;r<e.length;r++){var l=e[r],n=l.row,i=l.col,a=l.rowspan,c=l.colspan;if(-1<i&&-1<n&&a&&c){if(n===t&&i===o)return{rowspan:a,colspan:c};if(n<=t&&t<n+a&&i<=o&&o<i+c)return{rowspan:0,colspan:0}}}}var _default={name:"VxeTableFooter",props:{footerTableData:Array,tableColumn:Array,visibleColumn:Array,fixedColumn:Array,size:String,fixedType:String},mounted:function(){var e=this.$parent,t=this.$el,o=this.$refs,r=this.fixedType,l=e.elemStore,n="".concat(r||"main","-footer-");l["".concat(n,"wrapper")]=t,l["".concat(n,"table")]=o.table,l["".concat(n,"colgroup")]=o.colgroup,l["".concat(n,"list")]=o.tfoot,l["".concat(n,"xSpace")]=o.xSpace},render:function(A){var e=this._e,O=this.$parent,j=this.fixedType,t=this.fixedColumn,q=this.tableColumn,D=this.footerTableData,M=O.$listeners,o=O.tId,r=O.footerRowClassName,N=O.footerCellClassName,l=O.footerRowStyle,X=O.footerCellStyle,R=O.footerAlign,K=O.mergeFooterList,U=O.footerSpanMethod,V=O.align,z=O.scrollXLoad,B=O.columnKey,H=O.showFooterOverflow,W=O.currentColumn,Y=O.overflowX,n=O.scrollbarWidth,G=O.tooltipOpts;return K.length&&U||(j&&H?q=t:z&&j&&(q=t)),A("div",{class:["vxe-table--footer-wrapper",j?"fixed-".concat(j,"--wrapper"):"body--wrapper"],attrs:{"data-tid":o},on:{scroll:this.scrollEvent}},[j?e():A("div",{class:"vxe-body--x-space",ref:"xSpace"}),A("table",{class:"vxe-table--footer",attrs:{"data-tid":o,cellspacing:0,cellpadding:0,border:0},ref:"table"},[A("colgroup",{ref:"colgroup"},q.map(function(e,t){return A("col",{attrs:{name:e.id},key:t})}).concat(n?[A("col",{attrs:{name:"col_gutter"}})]:[])),A("tfoot",{ref:"tfoot"},D.map(function(L,E){var k=E;return A("tr",{class:["vxe-footer--row",r?_ctor.default.isFunction(r)?r({$table:O,_rowIndex:E,$rowIndex:k,fixed:j,type:cellType}):r:""],style:l?_ctor.default.isFunction(l)?l({$table:O,_rowIndex:E,$rowIndex:k,fixed:j,type:cellType}):l:null},q.map(function(t,e){var o,r=t.showFooterOverflow,l=t.footerAlign,n=t.align,i=t.footerClassName,a=G.showAll||G.enabled,c=t.children&&t.children.length,s=j?t.fixed!==j&&!c:t.fixed&&Y,f=_ctor.default.isUndefined(r)||_ctor.default.isNull(r)?H:r,u=l||n||R||V,d="ellipsis"===f,p="title"===f,y=!0===f||"tooltip"===f,m=p||y||d,v={"data-colid":t.id},b={},x=O.getColumnIndex(t),g=O.getVTColumnIndex(t),_={$table:O,_rowIndex:E,$rowIndex:k,column:t,columnIndex:x,$columnIndex:e,_columnIndex:g,itemIndex:g,items:L,fixed:j,type:cellType,data:D};if(z&&!m&&(d=m=!0),(p||y||a)&&(b.mouseenter=function(e){p?_tools.DomTools.updateCellTitle(e.currentTarget,t):(y||a)&&O.triggerFooterTooltipEvent(e,_)}),(y||a)&&(b.mouseleave=function(e){(y||a)&&O.handleTargetLeaveEvent(e)}),M["footer-cell-click"]&&(b.click=function(e){O.emitEvent("footer-cell-click",Object.assign({cell:e.currentTarget},_),e)}),M["footer-cell-dblclick"]&&(b.dblclick=function(e){O.emitEvent("footer-cell-dblclick",Object.assign({cell:e.currentTarget},_),e)}),K.length){var h=mergeFooterMethod(K,E,g);if(h){var w=h.rowspan,T=h.colspan;if(!w||!T)return null;1<w&&(v.rowspan=w),1<T&&(v.colspan=T)}}else if(U){var S=U(_)||{},$=S.rowspan,C=void 0===$?1:$,P=S.colspan,I=void 0===P?1:P;if(!C||!I)return null;1<C&&(v.rowspan=C),1<I&&(v.colspan=I)}var F="seq"===t.type||"index"===t.type?"seq":t.type;return A("td",{class:["vxe-footer--column",t.id,(o={},_defineProperty(o,"col--".concat(u),u),_defineProperty(o,"col--".concat(F),F),_defineProperty(o,"col--last",e===q.length-1),_defineProperty(o,"fixed--hidden",s),_defineProperty(o,"col--ellipsis",m),_defineProperty(o,"col--current",W===t),o),_tools.UtilTools.getClass(i,_),_tools.UtilTools.getClass(N,_)],attrs:v,style:X?_ctor.default.isFunction(X)?X(_):X:null,on:b,key:B?t.id:e},[A("div",{class:["vxe-cell",{"c--title":p,"c--tooltip":y,"c--ellipsis":d}]},t.renderFooter(A,_))])}).concat(n?[A("td",{class:"vxe-footer--gutter col--gutter"})]:[]))}))])])},methods:{scrollEvent:function(e){var t=this.$parent,o=this.fixedType,r=t.$refs,l=t.scrollXLoad,n=t.triggerScrollXEvent,i=t.lastScrollLeft,a=r.tableHeader,c=r.tableBody,s=r.tableFooter,f=r.validTip,u=a?a.$el:null,d=s?s.$el:null,p=c.$el,y=d.scrollLeft,m=y!==i;t.lastScrollLeft=y,t.lastScrollTime=Date.now(),u&&(u.scrollLeft=y),p&&(p.scrollLeft=y),l&&m&&n(e),m&&f&&f.visible&&f.updatePlacement(),t.emitEvent("scroll",{type:cellType,fixed:o,scrollTop:p.scrollTop,scrollLeft:y,isX:m,isY:!1},e)}}};exports.default=_default;